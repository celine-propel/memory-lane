<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ title or "Cognitive Check-In" }}</title>

  <!-- Optional: nicer font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="/static/css/style.css">
  <link rel="manifest" href="/static/manifest.json">

  <!-- iOS "app" feel -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
</head>

<body>
  <div class="app">
    <header class="topbar">
      <div class="topbar-left">
        <div class="app-title">Cognitive Check-In</div>
        <div class="app-subtitle">{{ subtitle or "Quick signals, tracked over time" }}</div>
      </div>
      {% if user %}
        <button class="avatar" id="avatarBtn" aria-label="Profile menu" type="button">
            <span>{{ user.name[:2]|upper }}</span>
        </button>

        <div class="menu" id="profileMenu" aria-hidden="true">
            <div class="menu-card">
            <div class="menu-title">{{ user.name }}</div>
            <a class="menu-item" href="/dashboard">Dashboard</a>
            <a class="menu-item danger" href="/logout">Log out</a>
            </div>
        </div>
        {% else %}
        <a class="btn" href="/login" style="text-decoration:none;">Log in</a>
        {% endif %}

    </header>

    <main class="content">
      {% block content %}{% endblock %}
    </main>

    <nav class="tabbar">
      <a class="tab" href="/tests" data-tab="tests">
        <div class="tab-label">Tests</div>
      </a>
      <a class="tab" href="/practice" data-tab="practice">
        <div class="tab-label">Practice</div>
      </a>
      <a class="tab" href="/dashboard" data-tab="dashboard">
        <div class="tab-label">Dashboard</div>
      </a>
    </nav>
  </div>

  <script>
    // Highlight active tab based on path
    const path = window.location.pathname;
    const map = { "/tests":"tests", "/practice":"practice", "/dashboard":"dashboard" };
    const active = map[path] || (path.startsWith("/tests") ? "tests" : null);
    if (active) {
      document.querySelectorAll(".tab").forEach(t => {
        if (t.dataset.tab === active) t.classList.add("active");
      });
    }
  </script>

  <script src="/static/js/app.js"></script>
</body>
</html>
